<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

    <title>M3-D8</title>
    
  </head>
  <body>

    <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd">
      <a class="navbar-brand" href="#">Amazon</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home<span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./backoffice.html">Form</a>
          </li>
        </ul>
      </div>
    </nav>

    <h3 class="text-center mt-5" style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">Amazon Description</h3>

    <div class="container-fluid mt-3">
      <table class="table table-striped bordless">
        <thead">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col ">Description</th>
            <th scope="col">Brand</th>
            <th scope="col">URL</th>
            <th scope="col">Price</th>
            <th scope='col'>Edit</th>
          </tr>
        </thead>
        <tbody id="table-body">
    
        </tbody>
      </table>
    </div>
    
    <script>      
      window.onload = async function(){

        const url = "https://striveschool-api.herokuapp.com/api/product/"
        const tableBody = document.getElementById('table-body')
        console.log('window loading');

    try{
      const response = await fetch(url, { 
        'method': "GET",
        'headers': {"Authorization":  "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MGFmYTc4NWJlOWIxNTAwMTU1MDZlNGYiLCJpYXQiOjE2MjUxNDcwMDcsImV4cCI6MTYyNjM1NjYwN30.2qJcSWRhgWTcWZ0EJLTja23VfJZr17yiqTaHgBv0qao",
       
        } 
    })

    const productName = await response.json()
    console.log(productName.length);

    if(productName.length > 0){
      productName.forEach((info, i) => {
        tableBody.innerHTML += `<tr>
                                  <th scope="row">${i+1}</th>
                                  <td>${info.name}</td>
                                  <td>${info.description}</td>
                                  <td>${info.brand}</td>
                                  <td><a href="${info.imageUrl}">Image</a></td>
                                  <td>â‚¬${info.price}</td>
                                  <td><button type="button" class="btn btn-primary">Edit</button></td>

                                </tr>`     
      });
    }else {
      tableBody.innerHTML = `<div class="alert alert-info" role="alert">
                                No events planned yet!
                              </div>`;
          }
    }catch(error){
      console.log(error);
    }
      }
    </script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

  </body>
</html>